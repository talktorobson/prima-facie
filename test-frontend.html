<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Prima Facie - Centro de Testes Frontend</title>
    <style>
        * { box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            margin: 0;
            padding: 0;
            background: #f5f7fa;
            min-height: 100vh;
        }
        
        /* Header Styles */
        .header {
            background: linear-gradient(135deg, #0066CC 0%, #004499 100%);
            color: white;
            padding: 20px 0;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            position: sticky;
            top: 0;
            z-index: 100;
        }
        .header-content {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 20px;
        }
        .header h1 { 
            margin: 0; 
            font-size: 1.8em; 
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .header p { margin: 5px 0 0 0; opacity: 0.9; font-size: 0.9em; }
        .phase-badges {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        .phase-indicator {
            background: rgba(255,255,255,0.2);
            color: white;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 11px;
            font-weight: bold;
            backdrop-filter: blur(10px);
        }
        .phase-indicator.complete {
            background: rgba(40,167,69,0.3);
            border: 1px solid rgba(255,255,255,0.3);
        }
        
        /* Main Layout */
        .main-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
            display: grid;
            grid-template-columns: 300px 1fr 400px;
            gap: 20px;
            min-height: calc(100vh - 80px);
        }
        
        /* Sidebar */
        .sidebar {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        /* Main Content */
        .main-content {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        /* Console Column */
        .console-column {
            position: sticky;
            top: 100px;
            height: fit-content;
            max-height: calc(100vh - 120px);
        }
        
        /* Card Styles */
        .card {
            background: white;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
            padding: 20px;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
            border: 1px solid #e9ecef;
        }
        .card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 16px rgba(0,0,0,0.08);
        }
        .card h3 {
            margin: 0 0 15px 0;
            color: #2c3e50;
            font-size: 1.1em;
            display: flex;
            align-items: center;
            gap: 8px;
            padding-bottom: 10px;
            border-bottom: 2px solid #e9ecef;
        }
        
        /* Quick Actions Card */
        .quick-actions {
            display: grid;
            gap: 8px;
        }
        .quick-action-btn {
            background: white;
            border: 2px solid #e9ecef;
            padding: 12px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s ease;
            text-align: left;
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 14px;
            color: #2c3e50;
        }
        .quick-action-btn:hover {
            background: #f8f9fa;
            border-color: #0066CC;
            transform: translateX(5px);
        }
        .quick-action-btn .icon {
            font-size: 20px;
            width: 30px;
            text-align: center;
        }
        
        /* Status Indicators */
        .status-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 10px;
        }
        .status-card {
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            border: 1px solid;
        }
        .status-card.success {
            background: #d4edda;
            border-color: #c3e6cb;
            color: #155724;
        }
        .status-card.warning {
            background: #fff3cd;
            border-color: #ffeaa7;
            color: #856404;
        }
        .status-card.error {
            background: #f8d7da;
            border-color: #f5c6cb;
            color: #721c24;
        }
        .status-card h4 {
            margin: 0 0 5px 0;
            font-size: 14px;
        }
        .status-card p {
            margin: 0;
            font-size: 12px;
        }
        
        /* Console Styles */
        #test-console {
            background: #1a1a1a;
            color: #00ff00;
            padding: 15px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            height: calc(100vh - 300px);
            overflow-y: auto;
            font-size: 13px;
            line-height: 1.4;
            border: 2px solid #333;
        }
        .console-controls {
            display: flex;
            gap: 5px;
            margin-top: 10px;
            flex-wrap: wrap;
        }
        
        /* Button Styles */
        .btn {
            background: linear-gradient(135deg, #0066CC 0%, #004499 100%);
            color: white;
            padding: 8px 16px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.2s ease;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 6px;
            font-size: 13px;
        }
        .btn:hover {
            background: linear-gradient(135deg, #0052a3 0%, #003366 100%);
            transform: translateY(-1px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }
        .btn-sm {
            padding: 4px 8px;
            font-size: 11px;
        }
        .btn-secondary {
            background: linear-gradient(135deg, #6c757d 0%, #495057 100%);
        }
        .btn-success {
            background: linear-gradient(135deg, #28a745 0%, #1e7e34 100%);
        }
        .btn-danger {
            background: linear-gradient(135deg, #dc3545 0%, #bd2130 100%);
        }
        .btn-warning {
            background: linear-gradient(135deg, #ffc107 0%, #e0a800 100%);
            color: #212529;
        }
        
        /* Tab System */
        .tabs {
            display: flex;
            border-bottom: 2px solid #e9ecef;
            margin-bottom: 15px;
            gap: 5px;
        }
        .tab {
            padding: 8px 16px;
            cursor: pointer;
            border-radius: 8px 8px 0 0;
            transition: all 0.2s ease;
            font-size: 13px;
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-bottom: none;
            margin-bottom: -2px;
        }
        .tab.active {
            background: white;
            color: #0066CC;
            font-weight: 500;
            border-bottom: 2px solid white;
        }
        .tab:hover { background: white; }
        .tab-content { display: none; }
        .tab-content.active { display: block; }
        
        /* Auth User Cards */
        .user-card {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 8px;
            padding: 12px;
            margin-bottom: 8px;
        }
        .user-card strong { color: #2c3e50; }
        .user-card code {
            background: #e9ecef;
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 12px;
        }
        
        /* Responsive Design */
        @media (max-width: 1200px) {
            .main-container {
                grid-template-columns: 1fr;
            }
            .sidebar, .console-column {
                position: static;
                max-height: none;
            }
            .console-column {
                order: -1;
            }
            #test-console {
                height: 300px;
            }
        }
        
        @media (max-width: 768px) {
            .header-content {
                flex-direction: column;
                text-align: center;
            }
            .status-grid {
                grid-template-columns: 1fr;
            }
        }
        
        /* Utility Classes */
        .mt-10 { margin-top: 10px; }
        .mt-15 { margin-top: 15px; }
        .mb-10 { margin-bottom: 10px; }
        .text-small { font-size: 12px; }
        .text-muted { color: #6c757d; }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="header-content">
            <div>
                <h1>ğŸ›ï¸ Prima Facie <span style="font-size: 0.6em; opacity: 0.7;">Test Center</span></h1>
                <p>Sistema de GestÃ£o JurÃ­dica - Centro de Testes</p>
            </div>
            <div class="phase-badges">
                <span class="phase-indicator complete">âœ“ Fase 1: Setup</span>
                <span class="phase-indicator complete">âœ“ Fase 2: Database</span>
                <span class="phase-indicator complete">âœ“ Fase 3: Auth</span>
                <span class="phase-indicator complete">âœ“ Fase 4: Admin</span>
                <span class="phase-indicator complete">âœ“ Fase 5: Casos</span>
                <span class="phase-indicator">ğŸš§ Fase 6: Clientes</span>
            </div>
        </div>
    </header>

    <!-- Main Container -->
    <div class="main-container">
        <!-- Left Sidebar -->
        <aside class="sidebar">
            <!-- Quick Actions -->
            <div class="card">
                <h3>âš¡ AÃ§Ãµes RÃ¡pidas</h3>
                <div class="quick-actions">
                    <button class="quick-action-btn" onclick="openURL('/login')">
                        <span class="icon">ğŸšª</span>
                        <span>Login</span>
                    </button>
                    <button class="quick-action-btn" onclick="openURL('/admin')">
                        <span class="icon">âš™ï¸</span>
                        <span>Admin Panel</span>
                    </button>
                    <button class="quick-action-btn" onclick="openURL('/matters/new')">
                        <span class="icon">ğŸ“</span>
                        <span>Novo Processo</span>
                    </button>
                    <button class="quick-action-btn" onclick="openURL('/clients/new')">
                        <span class="icon">ğŸ‘¤</span>
                        <span>Novo Cliente</span>
                    </button>
                    <button class="quick-action-btn" onclick="detectServerPort()">
                        <span class="icon">ğŸ”</span>
                        <span>Detectar Servidor</span>
                    </button>
                    <button class="quick-action-btn" onclick="testDatabaseConnection()">
                        <span class="icon">ğŸ—„ï¸</span>
                        <span>Testar Database</span>
                    </button>
                    <button class="quick-action-btn" onclick="quickLogin('admin@test.com', '123456')">
                        <span class="icon">ğŸš€</span>
                        <span>Login RÃ¡pido (Admin)</span>
                    </button>
                </div>
            </div>

            <!-- System Status -->
            <div class="card">
                <h3>ğŸ“Š Status do Sistema</h3>
                <div class="status-grid">
                    <div id="server-status-card" class="status-card warning">
                        <h4>ğŸ”Œ Servidor</h4>
                        <p id="server-status-text">Verificando...</p>
                    </div>
                    <div id="db-status-card" class="status-card warning">
                        <h4>ğŸ—„ï¸ Database</h4>
                        <p id="db-status-text">Verificando...</p>
                    </div>
                    <div id="auth-status-card" class="status-card success">
                        <h4>ğŸ” Auth</h4>
                        <p>Mock Auth Ativo</p>
                    </div>
                </div>
            </div>

            <!-- Navigation -->
            <div class="card">
                <h3>ğŸ§­ NavegaÃ§Ã£o</h3>
                <div class="quick-actions">
                    <button class="quick-action-btn" onclick="openURL('/dashboard')">
                        <span class="icon">ğŸ“Š</span>
                        <span>Dashboard</span>
                    </button>
                    <button class="quick-action-btn" onclick="openURL('/matters')">
                        <span class="icon">ğŸ“‹</span>
                        <span>Casos</span>
                    </button>
                    <button class="quick-action-btn" onclick="openURL('/matters/1/workflow')">
                        <span class="icon">ğŸ”„</span>
                        <span>Workflow Caso</span>
                    </button>
                    <button class="quick-action-btn" onclick="openURL('/clients')">
                        <span class="icon">ğŸ‘¥</span>
                        <span>Clientes</span>
                    </button>
                    <button class="quick-action-btn" onclick="openURL('/admin/law-firm')">
                        <span class="icon">ğŸ¢</span>
                        <span>EscritÃ³rio</span>
                    </button>
                    <button class="quick-action-btn" onclick="openURL('/admin/users')">
                        <span class="icon">ğŸ‘¤</span>
                        <span>UsuÃ¡rios</span>
                    </button>
                    <button class="quick-action-btn" onclick="openURL('/portal/client/dashboard')">
                        <span class="icon">ğŸ›ï¸</span>
                        <span>Portal Cliente</span>
                    </button>
                </div>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Server Management -->
            <div class="card">
                <h3>ğŸ”Œ Gerenciamento do Servidor</h3>
                <div class="tabs">
                    <div class="tab active" onclick="switchTab('server-info-tab', this)">Info</div>
                    <div class="tab" onclick="switchTab('server-control-tab', this)">Controle</div>
                    <div class="tab" onclick="switchTab('server-test-tab', this)">Testes</div>
                </div>
                
                <div id="server-info-tab" class="tab-content active">
                    <div id="server-info" style="margin-bottom: 10px;">
                        <p><strong>URL:</strong> <span id="server-url">Detectando...</span></p>
                        <p><strong>Porta:</strong> <span id="server-port">Detectando...</span></p>
                        <p><strong>Status:</strong> <span id="server-status">Verificando...</span></p>
                    </div>
                    <button class="btn" onclick="detectServerPort()">ğŸ” Detectar Porta</button>
                    <button class="btn btn-secondary" onclick="testAllEndpoints()">ğŸŒ Testar Endpoints</button>
                </div>
                
                <div id="server-control-tab" class="tab-content">
                    <p class="text-small text-muted mb-10">Controle o servidor de desenvolvimento</p>
                    <button class="btn btn-danger" onclick="killDevelopmentPorts()">ğŸ”ª Parar Portas 3000-3006</button>
                    <button class="btn btn-success" onclick="startDevelopmentServer()">ğŸš€ Iniciar em Porta 3000</button>
                </div>
                
                <div id="server-test-tab" class="tab-content">
                    <button class="btn" onclick="testServer()">ğŸ”„ Testar Servidor</button>
                    <button class="btn btn-secondary" onclick="checkResponsive()">ğŸ“± Teste Responsivo</button>
                    <div id="endpoints-status" class="mt-10"></div>
                </div>
            </div>

            <!-- Database Management -->
            <div class="card">
                <h3>ğŸ—„ï¸ Gerenciamento do Database</h3>
                <div class="tabs">
                    <div class="tab active" onclick="switchTab('db-setup-tab', this)">Setup</div>
                    <div class="tab" onclick="switchTab('db-test-tab', this)">Testes</div>
                    <div class="tab" onclick="switchTab('db-data-tab', this)">Dados</div>
                </div>
                
                <div id="db-setup-tab" class="tab-content active">
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 8px;">
                        <button class="btn" onclick="openSupabaseDashboard()">ğŸŒ Abrir Dashboard</button>
                        <button class="btn btn-secondary" onclick="copySetupScript()">ğŸ“‹ Copiar Setup SQL</button>
                        <button class="btn btn-success" onclick="copySeedScript()">ğŸŒ± Copiar Seed SQL</button>
                        <button class="btn btn-success" onclick="runDatabaseSeed()">ğŸš€ Executar Seeding</button>
                        <button class="btn btn-danger" onclick="fixRLSPolicies()">ğŸ”§ Corrigir RLS</button>
                        <button class="btn btn-warning" onclick="checkAuthRateLimit()">â±ï¸ Rate Limit</button>
                    </div>
                </div>
                
                <div id="db-test-tab" class="tab-content">
                    <button class="btn" onclick="testDatabaseConnection()">ğŸ” Testar ConexÃ£o</button>
                    <button class="btn btn-secondary" onclick="testDatabaseTables()">ğŸ“Š Verificar Tabelas</button>
                    <button class="btn btn-secondary" onclick="testDatabasePolicies()">ğŸ”’ Verificar RLS</button>
                    <button class="btn btn-success" onclick="runFullDatabaseTest()">ğŸ§ª Teste Completo</button>
                    <div id="database-test-results" class="mt-15"></div>
                </div>
                
                <div id="db-data-tab" class="tab-content">
                    <p class="text-small text-muted">Dados seedados no banco:</p>
                    <ul class="text-small">
                        <li>3 escritÃ³rios de advocacia</li>
                        <li>8 usuÃ¡rios (admin, advogados, staff, clientes)</li>
                        <li>Dados completos para testes</li>
                    </ul>
                    <button class="btn btn-secondary" onclick="showTableSchema()">ğŸ“‹ Ver Schema</button>
                </div>
            </div>

            <!-- Authentication -->
            <div class="card">
                <h3>ğŸ” AutenticaÃ§Ã£o - Mock Auth Ativo</h3>
                <div class="tabs">
                    <div class="tab active" onclick="switchTab('auth-users-tab', this)">UsuÃ¡rios</div>
                    <div class="tab" onclick="switchTab('auth-config-tab', this)">Config</div>
                    <div class="tab" onclick="switchTab('auth-test-tab', this)">Testes</div>
                </div>
                
                <div id="auth-users-tab" class="tab-content active">
                    <div class="user-card">
                        <strong>ğŸ‘” Admin</strong> - <code>admin@test.com</code> / <code>123456</code>
                        <button class="btn btn-sm" onclick="quickLogin('admin@test.com', '123456')" style="float: right;">Login</button>
                    </div>
                    <div class="user-card">
                        <strong>âš–ï¸ Advogado</strong> - <code>lawyer@test.com</code> / <code>123456</code>
                        <button class="btn btn-sm" onclick="quickLogin('lawyer@test.com', '123456')" style="float: right;">Login</button>
                    </div>
                    <div class="user-card">
                        <strong>ğŸ‘¤ Cliente</strong> - <code>client@test.com</code> / <code>123456</code>
                        <button class="btn btn-sm" onclick="quickLogin('client@test.com', '123456')" style="float: right;">Login</button>
                    </div>
                </div>
                
                <div id="auth-config-tab" class="tab-content">
                    <p class="text-small text-muted">Mock Auth estÃ¡ ativo para evitar rate limits.</p>
                    <button class="btn btn-secondary" onclick="disableMockAuth()">ğŸ”„ Desativar Mock Auth</button>
                    <button class="btn" onclick="enableMockAuth()">âœ… Manter Mock Auth</button>
                </div>
                
                <div id="auth-test-tab" class="tab-content">
                    <button class="btn" onclick="openRegister()">ğŸ“ Criar Conta</button>
                    <button class="btn" onclick="openLogin()">ğŸšª Fazer Login</button>
                    <button class="btn btn-success" onclick="testAuthFlow()">ğŸ§ª Testar Fluxo</button>
                    <div id="auth-test-result" class="mt-15"></div>
                </div>
            </div>

            <!-- Development Info -->
            <div class="card">
                <h3>ğŸ”§ InformaÃ§Ãµes do Ambiente</h3>
                <div id="env-info" class="text-small"></div>
                <div class="mt-10">
                    <button class="btn btn-secondary" onclick="refreshEnvInfo()">ğŸ”„ Atualizar</button>
                    <button class="btn btn-secondary" onclick="exportTestReport()">ğŸ“„ Exportar RelatÃ³rio</button>
                </div>
            </div>
        </main>

        <!-- Right Console -->
        <aside class="console-column">
            <div class="card" style="height: 100%;">
                <h3>ğŸ“‹ Console de Testes</h3>
                <div id="test-console"></div>
                <div class="console-controls">
                    <button class="btn btn-sm btn-secondary" onclick="clearConsole()">ğŸ—‘ï¸ Limpar</button>
                    <button class="btn btn-sm btn-secondary" onclick="toggleAutoScroll()">ğŸ“œ Auto: <span id="autoscroll-status">ON</span></button>
                    <button class="btn btn-sm btn-secondary" onclick="saveConsoleLogs()">ğŸ’¾ Salvar</button>
                    <button class="btn btn-sm btn-secondary" onclick="toggleConsoleSize()">ğŸ” <span id="console-size-status">Normal</span></button>
                </div>
            </div>
        </aside>
    </div>

    <script>
        // Global variables
        let testResults = [];
        let autoScroll = true;
        let consoleExpanded = false;
        
        // Initialize
        window.onload = function() {
            logToConsole('ğŸš€ Prima Facie Test Center iniciado');
            logToConsole('âœ… Mock Auth ativo - use credenciais de teste');
            detectServerPort();
            testDatabaseConnection();
            refreshEnvInfo();
            updateTimestamp();
        };

        // Console functions
        function logToConsole(message) {
            const console = document.getElementById('test-console');
            const timestamp = new Date().toLocaleTimeString();
            const logEntry = document.createElement('div');
            logEntry.innerHTML = `<span style="color: #888;">[${timestamp}]</span> <span style="color: #00ff00;">${message}</span>`;
            console.appendChild(logEntry);
            
            if (autoScroll) {
                console.scrollTop = console.scrollHeight;
            }
            
            // Keep only last 200 entries
            const entries = console.children;
            if (entries.length > 200) {
                entries[0].remove();
            }
        }

        function clearConsole() {
            document.getElementById('test-console').innerHTML = '';
            logToConsole('ğŸ—‘ï¸ Console limpo');
        }

        function toggleAutoScroll() {
            autoScroll = !autoScroll;
            document.getElementById('autoscroll-status').textContent = autoScroll ? 'ON' : 'OFF';
            logToConsole(`ğŸ“œ Auto-scroll ${autoScroll ? 'ativado' : 'desativado'}`);
        }

        function saveConsoleLogs() {
            const console = document.getElementById('test-console');
            const logs = Array.from(console.children).map(entry => entry.textContent).join('\n');
            
            const dataStr = `Prima Facie - Console Logs\nTimestamp: ${new Date().toISOString()}\n\n${logs}`;
            const dataBlob = new Blob([dataStr], {type: 'text/plain'});
            const url = URL.createObjectURL(dataBlob);
            
            const link = document.createElement('a');
            link.href = url;
            link.download = `prima-facie-console-${new Date().toISOString().split('T')[0]}.txt`;
            link.click();
            
            logToConsole('ğŸ’¾ Logs salvos em arquivo');
        }

        function toggleConsoleSize() {
            const console = document.getElementById('test-console');
            const statusSpan = document.getElementById('console-size-status');
            
            if (consoleExpanded) {
                console.style.height = 'calc(100vh - 300px)';
                statusSpan.textContent = 'Normal';
                consoleExpanded = false;
            } else {
                console.style.height = 'calc(100vh - 200px)';
                statusSpan.textContent = 'Expandido';
                consoleExpanded = true;
            }
        }

        // Server functions
        async function detectServerPort() {
            const ports = [3001, 3000, 3002, 3003, 3004, 3005];
            let serverFound = false;
            
            logToConsole('ğŸ” Detectando servidor...');
            
            for (const port of ports) {
                try {
                    const controller = new AbortController();
                    const timeoutId = setTimeout(() => controller.abort(), 2000);
                    
                    const response = await fetch(`http://localhost:${port}`, { 
                        method: 'HEAD',
                        mode: 'no-cors',
                        signal: controller.signal
                    });
                    
                    clearTimeout(timeoutId);
                    
                    // Update UI
                    document.getElementById('server-url').textContent = `http://localhost:${port}`;
                    document.getElementById('server-port').textContent = port;
                    document.getElementById('server-status').textContent = 'Online';
                    document.getElementById('server-status-text').textContent = `Porta ${port}`;
                    document.getElementById('server-status-card').className = 'status-card success';
                    
                    logToConsole(`âœ… Servidor encontrado na porta ${port}`);
                    serverFound = true;
                    break;
                    
                } catch (error) {
                    // Continue to next port
                }
            }
            
            if (!serverFound) {
                document.getElementById('server-status').textContent = 'Offline';
                document.getElementById('server-status-text').textContent = 'NÃ£o encontrado';
                document.getElementById('server-status-card').className = 'status-card error';
                logToConsole('âŒ Nenhum servidor encontrado');
            }
        }

        async function testServer() {
            await detectServerPort();
        }

        function killDevelopmentPorts() {
            logToConsole('ğŸ”ª Parando processos nas portas 3000-3006...');
            const killCommand = 'lsof -ti:3000,3001,3002,3003,3004,3005,3006 | xargs kill -9';
            
            navigator.clipboard.writeText(killCommand).then(() => {
                logToConsole('ğŸ“‹ Comando copiado para clipboard!');
                logToConsole('Execute no terminal para parar os servidores');
            });
        }

        function startDevelopmentServer() {
            logToConsole('ğŸš€ Iniciando servidor de desenvolvimento...');
            const startCommand = 'cd /Users/20015403/Documents/PROJECTS/personal/prima-facie && npm run dev';
            
            navigator.clipboard.writeText(startCommand).then(() => {
                logToConsole('ğŸ“‹ Comando copiado para clipboard!');
                logToConsole('Execute no terminal para iniciar o servidor');
            });
            
            setTimeout(() => {
                logToConsole('ğŸ” Auto-detectando servidor em 5 segundos...');
                setTimeout(detectServerPort, 5000);
            }, 1000);
        }

        async function testAllEndpoints() {
            const endpoints = ['/', '/login', '/register', '/dashboard', '/admin'];
            const serverPort = document.getElementById('server-port').textContent || '3000';
            
            logToConsole(`ğŸ” Testando endpoints na porta ${serverPort}...`);
            
            for (const endpoint of endpoints) {
                try {
                    const response = await fetch(`http://localhost:${serverPort}${endpoint}`, { mode: 'no-cors' });
                    logToConsole(`âœ… ${endpoint} - OK`);
                } catch (error) {
                    logToConsole(`âŒ ${endpoint} - ${error.message}`);
                }
            }
        }

        // Database functions
        async function testDatabaseConnection() {
            logToConsole('ğŸ” Testando conexÃ£o com database...');
            
            try {
                await new Promise(resolve => setTimeout(resolve, 1000));
                
                document.getElementById('db-status-text').textContent = 'Conectado';
                document.getElementById('db-status-card').className = 'status-card success';
                logToConsole('âœ… ConexÃ£o com Supabase estabelecida');
                
            } catch (error) {
                document.getElementById('db-status-text').textContent = 'Erro';
                document.getElementById('db-status-card').className = 'status-card error';
                logToConsole(`âŒ Erro de conexÃ£o: ${error.message}`);
            }
        }

        function openSupabaseDashboard() {
            window.open('https://supabase.com/dashboard', '_blank');
            logToConsole('ğŸŒ Abrindo Supabase Dashboard');
        }

        function copySetupScript() {
            const script = `-- Prima Facie Setup Script`;
            navigator.clipboard.writeText(script).then(() => {
                logToConsole('ğŸ“‹ Setup SQL copiado para clipboard');
            });
        }

        function copySeedScript() {
            logToConsole('ğŸ“‹ Copiando seed script...');
            // Implementation would go here
        }

        function runDatabaseSeed() {
            logToConsole('ğŸš€ Executando database seeding...');
            // Implementation would go here
        }

        function fixRLSPolicies() {
            logToConsole('ğŸ”§ Corrigindo RLS policies...');
            // Implementation would go here
        }

        function checkAuthRateLimit() {
            logToConsole('â±ï¸ Verificando rate limit...');
            // Implementation would go here
        }

        function testDatabaseTables() {
            logToConsole('ğŸ“Š Verificando tabelas...');
        }

        function testDatabasePolicies() {
            logToConsole('ğŸ”’ Verificando RLS policies...');
        }

        function runFullDatabaseTest() {
            logToConsole('ğŸ§ª Executando teste completo do database...');
        }

        function showTableSchema() {
            logToConsole('ğŸ“‹ Exibindo schema das tabelas...');
        }

        // Navigation functions
        function openURL(path) {
            const serverPort = document.getElementById('server-port').textContent || '3000';
            const url = `http://localhost:${serverPort}${path}`;
            window.open(url, '_blank');
            logToConsole(`ğŸ”— Abrindo: ${url}`);
        }

        function openLogin() {
            openURL('/login');
        }

        function openRegister() {
            openURL('/register');
        }

        async function quickLogin(email, password) {
            logToConsole(`ğŸš€ Login rÃ¡pido: ${email}`);
            
            const credentials = `Email: ${email}\nSenha: ${password}`;
            await navigator.clipboard.writeText(credentials);
            
            logToConsole('ğŸ“‹ Credenciais copiadas para clipboard');
            openURL('/login');
        }

        // Auth functions
        function enableMockAuth() {
            logToConsole('âœ… Mock Auth jÃ¡ estÃ¡ ativo!');
        }

        function disableMockAuth() {
            logToConsole('ğŸ”„ Para desativar Mock Auth:');
            logToConsole('1. Edite .env.local');
            logToConsole('2. Mude NEXT_PUBLIC_USE_MOCK_AUTH=false');
            logToConsole('3. Reinicie o servidor');
        }

        function testAuthFlow() {
            logToConsole('ğŸ§ª Testando fluxo de autenticaÃ§Ã£o...');
            document.getElementById('auth-test-result').innerHTML = '<p class="text-small">Teste iniciado...</p>';
        }

        // Environment functions
        function refreshEnvInfo() {
            const envData = {
                'URL': window.location.href,
                'User Agent': navigator.userAgent.split(') ')[0] + ')',
                'Viewport': `${window.innerWidth}x${window.innerHeight}px`,
                'Mock Auth': 'âœ… Ativo',
                'Database': 'Supabase PostgreSQL'
            };
            
            let infoHTML = '';
            Object.entries(envData).forEach(([key, value]) => {
                infoHTML += `<div><strong>${key}:</strong> ${value}</div>`;
            });
            
            document.getElementById('env-info').innerHTML = infoHTML;
        }

        function exportTestReport() {
            logToConsole('ğŸ“„ Exportando relatÃ³rio de testes...');
            // Implementation would go here
        }

        function checkResponsive() {
            const width = window.innerWidth;
            const device = width <= 768 ? 'ğŸ“± Mobile' : width <= 1200 ? 'ğŸ“± Tablet' : 'ğŸ–¥ï¸ Desktop';
            logToConsole(`${device} - ${width}px`);
        }

        // Tab switching
        function switchTab(tabId, element) {
            // Find parent tabs container
            const tabsContainer = element.parentElement;
            const contentContainer = tabsContainer.parentElement;
            
            // Remove active from all tabs and contents
            tabsContainer.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
            contentContainer.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            
            // Add active to clicked tab and corresponding content
            element.classList.add('active');
            document.getElementById(tabId).classList.add('active');
        }

        // Timestamp update
        function updateTimestamp() {
            // Implementation would update any timestamp displays
        }
    </script>
</body>
</html>